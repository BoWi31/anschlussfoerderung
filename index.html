<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anschlussförderung</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            text-align: center;
            transition: background-color 0.5s ease;
        }
        .status-container {
            padding: 20px;
            border-radius: 10px;
            background: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            width: 90%;
            max-width: 400px;
            transition: all 0.3s ease-in-out;
        }
        h1, p {
            margin: 0;
            color: black;
        }
        #countdown {
            margin-top: 10px;
            font-size: 1.2em;
            color: #555;
        }
    </style>
</head>
<body>
    <div id="status" class="status-container">
        <h1>Überprüfung läuft...</h1>
        <p id="next-session"></p>
        <p id="countdown"></p>
    </div>

    <script>
        const foerderzeiten = [
            { fach: "Deutsch", day: 1, start: "07:40", end: "09:30", klassen: ["1A", "1B"] }, // Montag
            { fach: "Deutsch", day: 2, start: "09:30", end: "11:20", klassen: ["1A", "1C"] }, // Dienstag
            { fach: "Deutsch", day: 4, start: "09:30", end: "11:20", klassen: ["2B"] }, // Donnerstag
            { fach: "Deutsch", day: 5, start: "11:20", end: "13:10", klassen: ["1A", "2C"] }, // Freitag
            { fach: "Mathe", day: 2, start: "11:20", end: "13:10", klassen: ["1B"] }, // Dienstag
            { fach: "Englisch", day: 3, start: "09:30", end: "11:20", klassen: ["1A"] }, // Mittwoch
            { fach: "Deutsch", day: 3, start: "18:30", end: "20:00", klassen: ["1A", "1B", "1C"] } // Mittwoch Abend
        ];

        function calculateCountdown(targetDate) {
            const jetzt = new Date();
            const diff = targetDate - jetzt;
            if (diff <= 0) return null;

            const hours = Math.floor(diff / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);

            return `${hours}h ${minutes}m ${seconds}s`;
        }

        function checkFoerderung() {
            const jetzt = new Date();
            const aktuelleZeitString = `${jetzt.getHours().toString().padStart(2, "0")}:${jetzt.getMinutes().toString().padStart(2, "0")}`;
            const aktuellerTag = jetzt.getDay(); // 0 = Sonntag, 1 = Montag ...
            const statusDiv = document.getElementById("status");
            let foerderungAktiv = false;
            let naechsteFoerderung = null;

            foerderzeiten.forEach(zeit => {
                const startZeit = zeit.start.split(":").map(Number);
                const endZeit = zeit.end.split(":").map(Number);
                const foerderTag = zeit.day;

                const foerderStart = new Date(jetzt);
                foerderStart.setHours(startZeit[0], startZeit[1], 0, 0);

                const foerderEnd = new Date(jetzt);
                foerderEnd.setHours(endZeit[0], endZeit[1], 0, 0);

                if (aktuellerTag === foerderTag && aktuelleZeitString >= zeit.start && aktuelleZeitString <= zeit.end) {
                    foerderungAktiv = true;
                    statusDiv.innerHTML = `
                        <h1>Anschlussförderung aktiv</h1>
                        <p><strong>Fach:</strong> ${zeit.fach}</p>
                        <p><strong>Klassen:</strong> ${zeit.klassen.join(", ")}</p>
                    `;
                    document.body.style.backgroundColor = "#dc3545"; // Rot
                } else if (!naechsteFoerderung || (foerderStart > jetzt && foerderStart < naechsteFoerderung.date)) {
                    // Nächste Förderung ermitteln
                    const naechsteZeit = new Date(jetzt);
                    naechsteZeit.setDate(jetzt.getDate() + (foerderTag + (7 - aktuellerTag)) % 7);
                    naechsteZeit.setHours(startZeit[0], startZeit[1], 0, 0);

                    naechsteFoerderung = { ...zeit, date: naechsteZeit };
                }
            });

            if (!foerderungAktiv && naechsteFoerderung) {
                const countdown = calculateCountdown(naechsteFoerderung.date);
                statusDiv.innerHTML = `
                    <h1>Keine Anschlussförderung</h1>
                    <p><strong>Nächste Förderung:</strong> ${naechsteFoerderung.fach} am ${naechsteFoerderung.date.toLocaleDateString("de-DE")} von ${naechsteFoerderung.start} bis ${naechsteFoerderung.end}</p>
                    <p id="countdown">Countdown: ${countdown}</p>
                `;
                document.body.style.backgroundColor = "#28a745"; // Grün
            } else if (!foerderungAktiv) {
                statusDiv.innerHTML = "<h1>Keine Anschlussförderung diese Woche</h1>";
                document.body.style.backgroundColor = "#ffc107"; // Gelb
            }
        }

        // Überprüfung alle 1 Sekunde
        setInterval(checkFoerderung, 1000);
        checkFoerderung();
    </script>
</body>
</html>
